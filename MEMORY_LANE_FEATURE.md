# Chá»©c nÄƒng Xem láº¡i Ká»· niá»‡m (Memory Lane)

## Tá»•ng quan

Chá»©c nÄƒng "Xem láº¡i Ká»· niá»‡m" cho phÃ©p ngÆ°á»i dÃ¹ng xem láº¡i cÃ¡c ghi chÃº Ä‘á»‹a Ä‘iá»ƒm cá»§a há» theo thá»i gian vÃ  hiá»ƒn thá»‹ lá»™ trÃ¬nh di chuyá»ƒn trÃªn báº£n Ä‘á»“.

## TÃ­nh nÄƒng

### 1. Filter theo thá»i gian

- **Quick filters**: HÃ´m nay, Tuáº§n nÃ y, ThÃ¡ng nÃ y, NÄƒm nÃ y, Táº¥t cáº£
- **Custom date range**: Chá»n khoáº£ng thá»i gian tÃ¹y chá»‰nh vá»›i date picker
- Tá»± Ä‘á»™ng lá»c ghi chÃº theo khoáº£ng thá»i gian Ä‘Ã£ chá»n

### 2. Hiá»ƒn thá»‹ danh sÃ¡ch ghi chÃº

- Hiá»ƒn thá»‹ táº¥t cáº£ ghi chÃº trong khoáº£ng thá»i gian Ä‘Ã£ chá»n
- Má»—i ghi chÃº hiá»ƒn thá»‹:
    - Sá»‘ thá»© tá»±
    - Mood/icon
    - Ná»™i dung
    - Äá»‹a chá»‰
    - Thá»i gian
    - Sá»‘ lÆ°á»£ng áº£nh (náº¿u cÃ³)
    - Preview áº£nh Ä‘áº§u tiÃªn

### 3. Thá»‘ng kÃª

- **Tá»•ng sá»‘ Ä‘á»‹a Ä‘iá»ƒm**: Sá»‘ lÆ°á»£ng ghi chÃº trong khoáº£ng thá»i gian
- **Sá»‘ ghi chÃº cÃ³ áº£nh**: Äáº¿m sá»‘ ghi chÃº cÃ³ kÃ¨m áº£nh
- **Tá»•ng quÃ£ng Ä‘Æ°á»ng**: TÃ­nh toÃ¡n khoáº£ng cÃ¡ch giá»¯a cÃ¡c Ä‘iá»ƒm (km)

### 4. Sáº¯p xáº¿p lá»™ trÃ¬nh

#### Theo thá»i gian (Time-based)

- Tá»± Ä‘á»™ng sáº¯p xáº¿p theo thá»© tá»± thá»i gian táº¡o ghi chÃº
- PhÃ¹ há»£p Ä‘á»ƒ xem láº¡i hÃ nh trÃ¬nh theo Ä‘Ãºng thá»i gian diá»…n ra

#### TÃ¹y chá»‰nh (Custom)

- Cho phÃ©p kÃ©o tháº£ (drag & drop) Ä‘á»ƒ sáº¯p xáº¿p láº¡i thá»© tá»±
- PhÃ¹ há»£p khi muá»‘n táº¡o lá»™ trÃ¬nh riÃªng khÃ´ng theo thá»i gian
- CÃ³ thá»ƒ sáº¯p xáº¿p láº¡i Ä‘á»ƒ tá»‘i Æ°u hÃ³a quÃ£ng Ä‘Æ°á»ng

### 5. Hiá»ƒn thá»‹ lá»™ trÃ¬nh trÃªn báº£n Ä‘á»“

#### Route visualization

- Váº½ Ä‘Æ°á»ng polyline mÃ u Ä‘á» (#FF6B6B) ná»‘i cÃ¡c Ä‘iá»ƒm
- Hiá»ƒn thá»‹ mÅ©i tÃªn chá»‰ hÆ°á»›ng di chuyá»ƒn
- Äá»™ rá»™ng vÃ  opacity tá»‘i Æ°u cho dá»… nhÃ¬n

#### Markers Ä‘áº·c biá»‡t

- **Äiá»ƒm báº¯t Ä‘áº§u**: Marker mÃ u xanh lÃ¡ (#4CAF50)
- **Äiá»ƒm dá»«ng**: Marker mÃ u cam (#FF6B6B) vá»›i sá»‘ thá»© tá»±
- **Äiá»ƒm káº¿t thÃºc**: Marker mÃ u Ä‘á» (#F44336)
- Hover Ä‘á»ƒ xem thÃ´ng tin chi tiáº¿t

#### Route info panel

- Hiá»ƒn thá»‹ thÃ´ng tin lá»™ trÃ¬nh:
    - Tá»•ng sá»‘ Ä‘iá»ƒm
    - Tá»•ng quÃ£ng Ä‘Æ°á»ng
    - PhÆ°Æ¡ng thá»©c sáº¯p xáº¿p
- Legend cho cÃ¡c loáº¡i marker
- NÃºt Ä‘Ã³ng Ä‘á»ƒ táº¯t hiá»ƒn thá»‹ route

#### Auto-fit bounds

- Tá»± Ä‘á»™ng zoom vÃ  center map Ä‘á»ƒ hiá»ƒn thá»‹ toÃ n bá»™ lá»™ trÃ¬nh
- Padding phÃ¹ há»£p Ä‘á»ƒ khÃ´ng bá»‹ che bá»Ÿi UI

## CÃ¡ch sá»­ dá»¥ng

### 1. Má»Ÿ Memory Lane

- Click vÃ o nÃºt **Calendar** (ğŸ“…) trÃªn FAB menu á»Ÿ gÃ³c dÆ°á»›i bÃªn pháº£i
- Hoáº·c cÃ³ thá»ƒ thÃªm vÃ o sidebar náº¿u cáº§n

### 2. Chá»n khoáº£ng thá»i gian

- Click vÃ o quick filter (HÃ´m nay, Tuáº§n nÃ y, ...) Ä‘á»ƒ lá»c nhanh
- Hoáº·c chá»n custom date range vá»›i date picker

### 3. Sáº¯p xáº¿p lá»™ trÃ¬nh

- Click "Theo thá»i gian" Ä‘á»ƒ sáº¯p xáº¿p theo thá»i gian táº¡o ghi chÃº
- Click "TÃ¹y chá»‰nh" vÃ  kÃ©o tháº£ cÃ¡c ghi chÃº Ä‘á»ƒ sáº¯p xáº¿p láº¡i

### 4. Xem lá»™ trÃ¬nh trÃªn báº£n Ä‘á»“

- Click nÃºt "Xem lá»™ trÃ¬nh trÃªn báº£n Ä‘á»“" á»Ÿ cuá»‘i danh sÃ¡ch
- Map sáº½ tá»± Ä‘á»™ng zoom vÃ  hiá»ƒn thá»‹ route vá»›i cÃ¡c marker
- Click vÃ o marker Ä‘á»ƒ xem thÃ´ng tin chi tiáº¿t
- Click nÃºt X trÃªn route info panel Ä‘á»ƒ Ä‘Ã³ng

## Cáº¥u trÃºc Code

### Components

- **`memory-lane-view.tsx`**: Dialog chÃ­nh hiá»ƒn thá»‹ danh sÃ¡ch ghi chÃº vÃ  filters
- **`route-display.tsx`**: Component hiá»ƒn thá»‹ lá»™ trÃ¬nh trÃªn map
- **`timeline/index.ts`**: Export file cho cÃ¡c components

### Store

- **`useMemoryLaneStore`**: Store quáº£n lÃ½ state cá»§a memory lane
    - `routeNotes`: Danh sÃ¡ch ghi chÃº Ä‘á»ƒ hiá»ƒn thá»‹ route
    - `routeSortBy`: PhÆ°Æ¡ng thá»©c sáº¯p xáº¿p ("time" | "custom")
    - `showRoute`: Boolean Ä‘á»ƒ hiá»ƒn thá»‹/áº©n route
    - `clearRoute()`: Function Ä‘á»ƒ clear route

- **`useUIStore`**: ThÃªm state
    - `showMemoryLane`: Boolean Ä‘á»ƒ má»Ÿ/Ä‘Ã³ng memory lane dialog

### Integration

- TÃ­ch há»£p vÃ o `map-container.tsx`
- ThÃªm nÃºt vÃ o `map-controls.tsx` FAB menu
- Sá»­ dá»¥ng Mapbox GL JS Ä‘á»ƒ váº½ route vÃ  markers

## Technologies

- **React**: Component-based UI
- **Zustand**: State management
- **Mapbox GL JS**: Map rendering vÃ  route visualization
- **Tailwind CSS**: Styling
- **Shadcn/ui**: UI components (Dialog, Card, Button, Input, Badge)
- **Lucide React**: Icons
- **Sonner**: Toast notifications

## TÃ­nh toÃ¡n

### Haversine Formula

Sá»­ dá»¥ng cÃ´ng thá»©c Haversine Ä‘á»ƒ tÃ­nh khoáº£ng cÃ¡ch giá»¯a 2 Ä‘iá»ƒm trÃªn máº·t cáº§u (TrÃ¡i Äáº¥t):

```javascript
const R = 6371; // BÃ¡n kÃ­nh TrÃ¡i Äáº¥t (km)
const dLat = ((lat2 - lat1) * Math.PI) / 180;
const dLng = ((lng2 - lng1) * Math.PI) / 180;
const a =
    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
    Math.cos((lat1 * Math.PI) / 180) *
        Math.cos((lat2 * Math.PI) / 180) *
        Math.sin(dLng / 2) *
        Math.sin(dLng / 2);
const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
const distance = R * c;
```

## UI/UX Design

### Colors (Pinory Theme)

- Primary: `#FF6B6B` (Coral Red)
- Secondary: `#FF8E53` (Orange)
- Accent: `#FFD6A5` (Peach)
- Background: `#0C0C0C` (Dark)
- Text: `#EDEDED` (Light gray)
- Muted: `#A0A0A0` (Gray)

### Interactions

- Smooth transitions vÃ  animations
- Hover effects trÃªn táº¥t cáº£ interactive elements
- Loading states cho async operations
- Toast notifications cho feedback
- Drag & drop vá»›i visual feedback

### Responsive

- Dialog responsive vá»›i max-width vÃ  max-height
- Scroll trong danh sÃ¡ch ghi chÃº
- Grid layout cho stats vÃ  filters
- Mobile-friendly vá»›i touch interactions

## Future Enhancements

1. **Export route**: Xuáº¥t lá»™ trÃ¬nh ra file GPX/KML
2. **Share route**: Chia sáº» lá»™ trÃ¬nh vá»›i link
3. **Route optimization**: Tá»± Ä‘á»™ng tá»‘i Æ°u hÃ³a lá»™ trÃ¬nh
4. **Multiple routes**: So sÃ¡nh nhiá»u lá»™ trÃ¬nh
5. **Route statistics**: ThÃªm thá»‘ng kÃª chi tiáº¿t (thá»i gian di chuyá»ƒn Æ°á»›c tÃ­nh, ...)
6. **Filter by category**: Lá»c theo loáº¡i Ä‘á»‹a Ä‘iá»ƒm
7. **Timeline view**: Hiá»ƒn thá»‹ dáº¡ng timeline thay vÃ¬ list
8. **Animation**: Animate route drawing vÃ  marker placement
9. **Clustering**: NhÃ³m cÃ¡c marker gáº§n nhau khi zoom out
10. **Heatmap**: Hiá»ƒn thá»‹ heatmap cá»§a cÃ¡c Ä‘á»‹a Ä‘iá»ƒm thÆ°á»ng xuyÃªn ghÃ© thÄƒm

## Notes

- Cáº§n cÃ³ Ã­t nháº¥t 2 ghi chÃº Ä‘á»ƒ hiá»ƒn thá»‹ route
- Route chá»‰ hiá»ƒn thá»‹ khi cÃ³ Ä‘á»§ dá»¯ liá»‡u (coordinates)
- Sá»­ dá»¥ng built-in Mapbox arrow icon cho route direction
- Map markers Ä‘Æ°á»£c cleanup khi component unmount
- Táº¥t cáº£ state Ä‘Æ°á»£c quáº£n lÃ½ bá»Ÿi Zustand store
